{% extends 'base.html' %}
{% load  static %}

{% block content %}
    <script src="{% static '/js/moment.js' %}"></script>
    <script src="{% static '/js/bootstrap-datetimepicker.min.js' %}"></script>
    <link rel="stylesheet" href="{% static '/css/bootstrap-datetimepicker.min.css' %}">


    {#<div class="container">#}
    <div class="row">

        <div class='col-sm-6 col-md-4 '>
            <div >
                <label class="control-label">日期：</label>
                <input type='text' class="form-control" id='datetimepicker' placeholder="{{ date_str }}"/>

            </div>

        </div>
        <a class="btn btn-default" onclick="queryAppts(this)"> 查询</a>
        <a class="btn btn-default" href="{% url 'appointment:appts_one_month' %}"> 未来30天预约</a>
    </div>

    <div class="col-md-12">
        <table class="table table-striped table-hover">
            <thead>
            <tr style="background-color: #99CCFF">
                <th>序号</th>
                <th>患者</th>
                <th>预约时间</th>
                <th>备注</th>
            </tr>
            </thead>

            {% if apptItem %}
                {% for appt in apptItem %}
                    <tr class="dataLine" onclick="changeColor(this)">
                        <td>{{ forloop.counter }}</td>
                        <td><a href="{% url 'boards:person_detail' appt.patient.pk %}">
                            <strong style="color: #0a0a0a">{{ appt.patient }}</strong> </a></td>
                        <td>{{ appt.startDateTime }}</td>
    {#                    <td>{{ appt.checkInTime|time:"H:i" }}</td>#}

    {#                    <td>{% if appt.checkInType == '初诊' %}  {{ appt.checkInType }}#}
    {#                        <i class="fa fa-check-circle-o " style="color: #00a157"></i>#}
    {#                    {% else %}  {{ appt.checkInType }}#}
    {#                    {% endif %}#}
                        </td>
    {#                    <td>{{ appt.doctorName|default_if_none:'_' }}</td>#}
                        {#                    <td>{{ appt.assistantName|default_if_none:'_' }}</td>#}

                        <td>{{ appt.comment|default_if_none:'' }}</td>

                    </tr>
                {% empty %}
                    <li>今日无预约</li>
                {% endfor %}
            {% endif %}

        </table>

    </div>


    {#</div>#}


    <script type="text/javascript">
        $(function () {
            $('#datetimepicker').datetimepicker({
                showTodayButton: true,
                format: 'YYYY-MM-DD',
            });
        });

        function queryAppts() {
            var url = '/appt/?date=' + $('#datetimepicker').val()
            {#window.location.href(url)#}
            location.assign(url)
        }

        function changeColor(line) {
            $('.dataLine').css('backgroundColor', '');
            line.style.backgroundColor = '#339999';
        }
    </script>

{% endblock %}