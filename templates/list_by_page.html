
{% extends 'base.html' %}

{% block title %}病历管理系统
{% endblock %}

{% block link %}
    {#    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>#}
{% endblock %}
{% block breadcrumb %}
    <li class="breadcrumb-item"><a href="{% url 'home' %}">首页</a></li>
    <li class="breadcrumb-item active">{{ persons.name }}</li>
{% endblock %}

{% block stylesheet %}
    <style>
        ul {
            list-style-type:none;
            margin:0;
            padding:0;
            display:inline;
        }
        li.pic {
            display:inline;
            border-radius: 3px;
            margin: 6px;

        }
        img{
            max-height: 100px;
        }
        .infocard{
            margin: 12px;
        {#background-color: rgba(236,236,255,0.47);#}
        {#background-color: #fff;#}
            border-radius: 3px;
            box-shadow: 0 2px 3px rgba(0,0,0,.1);
            border-bottom: 1px solid #e2e2e2;

            border-left: 0.3em solid rgb(66,185,131);
            padding-left: 0.7em;
            padding-bottom: 0.9em;
            padding-top: 0.9em;
            font-size: 1.0em;
            color: #888;
            background: none repeat scroll 0 0 rgba(66, 185, 131, 0.13);
            margin-bottom: 0.5em;
            margin-top: 0.5em;
        }
        .infocard:hover{
            margin: 12px;
        {#background-color: rgba(236,236,255,0.47);#}
            background-color: #23aeff;
            border-radius: 3px;
            box-shadow: 0 2px 3px rgba(0,0,0,.1);
            border-bottom: 1px solid #e2e2e2;

            border-left: 0.3em solid rgb(66,185,131);
            padding-left: 0.7em;
            padding-bottom: 0.9em;
            padding-top: 0.9em;
            font-size: 1.0em;
            color: #888;
        {#background: none repeat scroll 0 0 rgba(66, 185, 131, 0.13);#}
            margin-bottom: 0.5em;
            margin-top: 0.5em;
        }
    </style>
{% endblock %}


{% block content %}
    <script>
        {#toastr.info('道路千万条，安全第一条。','流浪地球')#}
    </script>

    <!--  主体列表  -->
    <div class="col-lg-12 col-sm-12  row">
        <br>
        <div class="md-8 ">
            <a href="{% url 'boards:new_person' %}" class="btn btn-primary">添加新患者</a>
        </div>

        <div class="row">
            {% for person in persons %}
                <div class="infocard row" pk="{% url 'boards:person_detail' person.pk %}">
                    <div class="col-md-2">
                        <div>
                            <a href="{% url 'boards:person_detail' person.pk %}"><h4>{{ person.name }}</h4></a>
                        </div>
                        <div>{{ person.idnum|default:_('') }}</div>
                        <div><span class="label label-success">{{ person.posts.count|default:_('') }} </span></div>
                    </div>


                    <div class="col-md-10">
                        {% with p=person.posts.first %}
                            {% if p %}
                                <ul>
                                    {% for img in p.images.all %}
                                        {% if forloop.counter < 5 %}
                                            <li class="pic">
                                                <img src="{{ img.thumbnail }}">
                                            </li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <p class="text-muted d-block">暂无照片</p>
                            {% endif %}
                        {% endwith %}
                    </div>
                </div>
            {% endfor %}
        </div>

        <!--  主体列表  -->
        {#    <div class="col-lg-12 col-sm-12  row">#}
        {#        <br>#}
        {#        <div class="md-8 ">#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">添加新患者</a>#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">待定</a>#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">待定</a>#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">待定</a>#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">待定</a>#}
        {#            <a href="{% url 'new_person' %}" class="btn btn-primary">待定</a>#}
        {#        </div>#}
        {##}
        {#        <div class="panel panel-default">#}
        {#            <div class="panel-body">#}
        {#                <table class="table table-hover">#}
        {#                    <thead class="thead-inverse">#}
        {#                    <tr>#}
        {#                        <th>患者姓名</th>#}
        {#                        <th>病历号</th>#}
        {#                        <th>上传次数</th>#}
        {#                        <th class="hidden-xs">性别</th>#}
        {#                        {% if user.username == 'zdl' %}#}
        {#                            <td class="hidden-xs"> 医生</td>#}
        {#                        {% endif %}#}
        {#                        <th class="hidden-xs">序号</th>#}
        {#                        <th class="hidden-xs">最后上传时间</th>#}
        {#                    </tr>#}
        {#                    </thead>#}
        {#                    <!--- 列表 --->#}
        {#                    <tbody>#}
        {#                    {% for person in persons %}#}
        {#                        <tr>#}
        {#                            <td>#}
        {#                                <a href="{% url 'person_detail' person.pk %}"><strong>{{ person.name }}</strong></a>#}
        {#                                <small class="text-muted d-block">{{ person.idnum  |default:_('') }}</small>#}
        {#                            </td>#}
        {#                            <td>{{ person.idnum |default:_('') }}</td>#}
        {#                            <td><span class="badge">{{ person.posts.count }} </span></td>#}
        {#                            <td class="hidden-xs">#}
        {#                                {% if person.sex == 1 %}男{% endif %}#}
        {#                                {% if person.sex == 2 %}女{% endif %}#}
        {##}
        {#                            </td>#}
        {#                            {% if user.username == 'zdl' %}#}
        {#                                {% if not person.doctor %}#}
        {#                                    <td class="hidden-xs"> 无</td>{% endif %}#}
        {#                                {% if person.doctor %}#}
        {#                                    <td class="hidden-xs"> {{ person.doctor |default:_('') }}</td> {% endif %}#}
        {#                            {% endif %}#}
        {##}
        {#                            <td class="hidden-xs">{{ person.pk }}</td>#}
        {#                            <td class="hidden-xs">{{ person.last_updated }}</td>#}
        {#                        </tr>#}
        {#                    {% endfor %}#}
        {#                    </tbody>#}
        {#                </table>#}
        {#            </div>#}
        {#        </div>#}

        <!--- 分页 ---->
        {% if persons.has_other_pages %}
            <nav aria-label="persons pagination" class="mb-4">
                <ul class="pagination">
                    <li class="page-item">
                        <a class="page-link" href="?page=1"><span class="fa fa-step-backward"></span> 首页 </a>
                    </li>
                    {% if persons.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ persons.previous_page_number }}"><span
                                    class="fa fa-chevron-left"></span>上一页 </a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <span class="page-link"><span class="fa fa-chevron-left"></span> 上一页</span>
                        </li>
                    {% endif %}
                    <li class="page-item active">
            <span class="page-link">
              第 {{ persons.number }} 页 | 共{{ persons.paginator.num_pages }}页
              <span class="sr-only">(current)</span>
            </span>
                    </li>


                    {% if persons.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ persons.next_page_number }}">下一页 <span
                                    class="fa fa-chevron-right"></span></a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <span class="page-link">下一页 <span class="fa fa-chevron-right"></span></span>
                        </li>
                    {% endif %}

                    <li class="page-item">
                        <a class="page-link" href="?page={{ persons.paginator.num_pages }}">最后页 <span
                                class="fa fa-step-forward"></span></a>
                    </li>
                </ul>
            </nav>
        {% endif %}

    </div>

    <!-- 点击选项卡跳转页面-->
    <script>
        $(".infocard").click(function () {
            let pk = $(this).attr("pk")

            window.location.href=pk
        })

    </script>


{% endblock %}