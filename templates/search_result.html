{% extends 'base.html' %}

{% block title %}搜索结果{% endblock %}

{% block breadcrumb %}
  <li class="breadcrumb-item"><a href="{% url 'home' %}">首页</a></li>
  <li class="breadcrumb-item active">搜索结果</li>
{% endblock %}

{% block stylesheet %}
    <style>
        ul {
            list-style-type:none;
            margin:0;
            padding:0;
             display:inline;
        }
        li {
            display:inline;
            border-radius: 3px;
            margin: 6px;

        }
        img{
            max-height: 100px;
        }
        .resultNum{
            color: #d43f3a;
        }
        .infocard{
        margin: 12px;
        {#background-color: rgba(236,236,255,0.47);#}
        {#background-color: #fff;#}
        border-radius: 3px;
        box-shadow: 0 2px 3px rgba(0,0,0,.1);
        border-bottom: 1px solid #e2e2e2;

        border-left: 0.3em solid rgb(66,185,131);
        padding-left: 0.7em;
        padding-bottom: 0.9em;
        padding-top: 0.9em;
        font-size: 1.0em;
        color: #888;
        background: none repeat scroll 0 0 rgba(66, 185, 131, 0.13);
        margin-bottom: 0.5em;
        margin-top: 0.5em;
    }
    .infocard:hover{
        margin: 12px;
        {#background-color: rgba(236,236,255,0.47);#}
        background-color: #23aeff;
        border-radius: 3px;
        box-shadow: 0 2px 3px rgba(0,0,0,.1);
        border-bottom: 1px solid #e2e2e2;

        border-left: 0.3em solid rgb(66,185,131);
        padding-left: 0.7em;
        padding-bottom: 0.9em;
        padding-top: 0.9em;
        font-size: 1.0em;
        color: #888;
        {#background: none repeat scroll 0 0 rgba(66, 185, 131, 0.13);#}
        margin-bottom: 0.5em;
        margin-top: 0.5em;
    }
    </style>
{% endblock %}

{% block content %}
    <h4><strong> 搜索结果</strong>: 共找到 <span class="resultNum"> {{ total }}</span> 个</h4>
    <hr>

<div class="row">

{% for person in persons %}
    <div class="infocard row" pk="{% url 'person_detail' person.pk %}">

        <div class="col-md-1">
            <div>
            <a href="{% url 'person_detail' person.pk %}"><h4>{{ person.name }}</h4></a>
{#            <small class="text-muted d-block">{{ person.idnum}}</small>#}
            </div>
            <div>{{ person.idnum|default:_('') }}</div>
            <div> <span class="label label-success">{{ person.posts.count|default:_('')  }} </span></div>
{#            <div>#}
{#                {% if person.sex == 1 %}男{% endif %}#}
{#                {% if person.sex == 2 %}女{% endif %}#}
{#            </div>#}
{#            <div>{{ person.pk }}</div>#}
        </div>


        <div class="col-md-10">
            {% with p=person.posts.first  %}
                {% if p %}
                    <ul >
                        {% for img in p.images.all %}
                            {% if forloop.counter < 5 %}
                                <li class="pic">
                                 <img  src="{{ img.thumbnail }}" >
                                </li>
                            {% endif %}
{#                            <li>#}
{#                                 <img  src="{{ img.thumbnail }}" >#}
{#                            </li>#}
                        {% endfor %}
                    </ul>
                {% else %}
                    <h5 class="text-muted d-block">暂无照片</h5>
                {% endif %}
            {% endwith %}
        </div>
    </div>
  {% endfor %}
</div>

<!--- 分页 ---->
    {% if persons.has_other_pages %}
      <nav aria-label="persons pagination" class="mb-4">
        <ul class="pagination">
          {% if persons.has_previous %}
            <li class="page-item">
                {% if s %}
                    <a class="page-link" href="?s={{ s }}&page={{ persons.previous_page_number }}">上一页</a>
                {% else %}
                  <a class="page-link" href="?page={{ persons.previous_page_number }}">上一页</a>
                {% endif %}

            </li>
          {% else %}
            <li class="page-item disabled">
              <span class="page-link">上一页</span>
            </li>
          {% endif %}
          <li class="page-item active">
            <span class="page-link">
              {{ persons.number }}
              <span class="sr-only">(current)</span>
            </span>
          </li>


          {% if persons.has_next %}
            <li class="page-item">
{#              <a class="page-link" href="?page={{ persons.next_page_number }}">下一页</a>#}
                {% if s %}
                    <a class="page-link" href="?s={{ s }}&page={{ persons.next_page_number }}">下一页</a>
                {% else %}
                  <a class="page-link" href="?page={{ persons.next_page_number }}">下一页</a>
                {% endif %}
            </li>
          {% else %}
            <li class="page-item disabled">
              <span class="page-link">下一页</span>
            </li>
          {% endif %}

        </ul>
      </nav>
    {% endif %}

<script>
$(document).ready(function (){
    $(".infocard").click(function () {
        let pk = $(this).attr("pk")

        window.location.href=pk
    })
    }
)
</script>



{% endblock %}